<!DOCTYPE html>
<html lang="en">
<head>

	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Harry Potter – CTF Walkthrough | Rahul Setrakian</title>
	<link rel="stylesheet" href="/assets/css/style.css" type="text/css"/>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
	<link rel="manifest" href="/site.webmanifest">
	<meta property="og:title" content="Harry Potter – CTF Walkthrough" />
	<meta property="og:description" content="Harry Potter CTF walkthrough, This is the official write-up, and I will guide you through the whole process step by step." />
	<meta property="og:image" content="/post/harry.jpg" />
	<meta name="twitter:title" content="Harry Potter – CTF Walkthrough" />
	<meta name="twitter:description" content="Harry Potter CTF walkthrough, This is the official write-up, and I will guide you through the whole process step by step." />
	 
	</head>

<body>


	  

<header class="header fade-in" id="header">
  <nav class="navbar container">
     <a href="/" class="brand">Rahul S.</a>
     <div class="burger" id="burger">
        <span class="burger-line"></span>
        <span class="burger-line"></span>
        <span class="burger-line"></span>
     </div>
     <div class="menu" id="menu">
        <ul class="menu-inner">

          
          
          <li class="menu-item">
            <a href="/" class="menu-link">Home</a>
          </li>
          
          
          
          <li class="menu-item">
            <a href="/about" class="menu-link">About</a>
          </li>
          
          
          
          <li class="menu-item">
            <a href="/portfolio" class="menu-link">Portfolio</a>
          </li>
          
          
          
          <li class="menu-item">
            <a href="/blog" class="menu-link">Blog</a>
          </li>
          
          
          
          <li class="menu-item">
            <a href="/contact" class="menu-link">Contact</a>
          </li>
          
          

        </ul>
     </div>
     <a href="https://in.linkedin.com/in/rahulsetrakian" class="menu-block">Resume</a>
  </nav>
</header>

<main class="container content">
		

<p>








<section class="article fade fadedown">
        <article>
            <header class="dark-overlay" style="background-image: url('/post/harry.jpg');">
                <div class="upper-header">
                    <div class="mini-title">Blog</div>
                </div>
                <div class="lower-header">
                    <div class="tags-container">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                            <defs>
                                <style>
                                    .d {
                                        width: 20px;
                                        fill: #fff;
                                        opacity: .75;
                                    }
                                </style>
                            </defs>
                            <path class="d" d="M19.22,9.66L10.77,1.21c-.74-.74-1.86-1.21-2.97-1.21H1.67C.75,0,0,.75,0,1.67V7.8c0,1.11,.46,2.23,1.3,2.97l8.45,8.46c1,1,2.62,1,3.62,0l5.94-5.95c.93-.93,.93-2.6-.09-3.62ZM6.96,6.35c-.59,.59-1.56,.59-2.15,0-.59-.59-.59-1.56,0-2.15,.59-.59,1.56-.59,2.15,0,.59,.59,.59,1.56,0,2.15Z" />
                        </svg>
                        <span>TryHackMe, Write-Up, CTF</span>
                    </div>
                    <h1 class="title"> Harry Potter – CTF Walkthrough </h1>
                    <p class="subtitle"> Harry Potter CTF walkthrough, This is the official write-up, and I will guide you through the whole process step by step. </p>
                </div>
            </header>
            <section class="summary">
                <div class="summary-item">
                    <h5 class="item-title">Reading Time</h5>
                    <p class="item-text"><span class="item-data" id="timeData"></span> Mins</p>
                </div>
                <div class="summary-item">
                    <h5 class="item-title">View</h5>
                    <p class="item-text"><span class="item-data" id="viewStat"></span> Views</p>
                </div>
                <div class="summary-item">
                    <h5 class="item-title">Publish Date</h5>
                    <p class="item-text">
                        <span class="item-data" id="dateData"> 
                                July 25, 2023
                        </span>
                    </p>
                </div>
            </section>
        </article>
</section>



<script>
    var r = new XMLHttpRequest();
    r.addEventListener('load', function() {
        document.querySelector('#viewStat').innerText = JSON.parse(this.responseText).count
    })
    const lastSlashIndex = location.pathname.lastIndexOf('/');
    const pathWithoutLastSlash = location.pathname.substring(0, lastSlashIndex) + location.pathname.substring(lastSlashIndex + 1);
    r.open('GET', 'https://rahulsetrakian.goatcounter.com/counter/' + encodeURIComponent(pathWithoutLastSlash) + '.json');
    r.send()
</script>






<section class="article-post">
    <section class="main-article fade fadeup">
        <h2 id="ctf-walkthrough">CTF Walkthrough</h2>
<p>Hello there, welcome to the official write-up of Harry Potter – CTF. I created this room for fun. I made this room in a few hours. If anyone is interested in knowing how to create a TryHackMe room, please comment down. I am using Kali Linux for this walkthrough. If you have a problem understanding any Linux command, check out <a href="https://explainshell.com/">Explain Shell</a>.</p>
<h3 id="enumeration">Enumeration</h3>
<p>We can begin by starting the machine by clicking the green button “Start Machine”, and wait till the IP Address appears.</p>
<p>We will perform a Nmap scan on the IP Address. If you are unfamiliar with Nmap, check out this “<a href="https://www.youtube.com/watch?v=4t4kBkMsDbQ">Nmap Tutorial to find Network Vulnerabilities</a>“. For that, we will use the following syntax.</p>
<blockquote>
<p>“nmap -A ipaddress”</p>
</blockquote>
<p>After performing the Nmap scan, we discover that the host has few services running, like FTP, SSH, and HTTP web server. We also gathered some information regarding the Operating System of the host, and it appears to be running Ubuntu.</p>
<h3 id="ftp-server">FTP Server</h3>
<p>The host supports anonymous FTP login without a password, and there is a file named “<strong>resurrection_stone.flag</strong>“. To connect to the FTP, write the following command.</p>
<blockquote>
<p>ftp ipaddress</p>
</blockquote>
<p>Once we connect to the FTP service, it will prompt for a name, so provide “anonymous” as a name.</p>
<p>Now use the “ls” command to list the FTP directory’s content. There is a file named “resurrection_stone.flag”. To download it, use the following command.</p>
<blockquote>
<p>get filename</p>
</blockquote>
<p>Type “quit” to exit the FTP service.</p>
<p>Now, look at the content of the file by using the following command.</p>
<blockquote>
<p>cat resurrection_stone.flag</p>
</blockquote>
<p>Hurray! we got our first flag. Since we do not have SSH credentials, we should check out the webpage on the host web server, and we know that the host is using an Nginx Server as the web server.</p>
<h3 id="webserver">Webserver</h3>
<p>We are greeted with a welcome page from Hogwarts, and we see a clue in the paragraph section of the page. It asks for a spell; let’s see if we can find anything in the source.</p>
<p>We see a comment saying “&lt;!– use the unlocking charm –&gt;”. After a quick google search, there is an incantation in Harry Potter called “Alohomora”, and we can look for this as a directory.</p>
<p>There is a page called “alohomora”, which has a quiz-like form. If anyone here is a Harry Potter fan, then answer the questions. (Well, you can always use google.)</p>
<p>Once we have answered the questions, we are given a URL. The URL looks to be pointing us to an image(.jpg). We can download the image with the “wget” command.</p>
<blockquote>
<p>wget url</p>
</blockquote>
<h3 id="steganography">Steganography</h3>
<p>We can look at the metadata to gather information regarding the image, using the following command to view the metadata.</p>
<blockquote>
<p>exiftool filename.jpg</p>
</blockquote>
<p>After a close inspection, we have two findings, and the description has a phase “I solemnly swear I am up to no good.” and the comment “lowercase and underscore.” after a quick googling, e.g. “I solemnly swear I am up to no good harry potter.” We come across a name, “Marauder’s map”.</p>
<p>We got a name and a clue that says use lowercase and underscore. Now we can perform a <a href="https://stegonline.georgeom.net/checklist">steganography check</a> on the image file. We can use steghide to extract the hidden file with the password “marauders_map”. We can use steghide to extract the hidden file. Use the following command.</p>
<blockquote>
<p>steghide extract -sf filename.jpg</p>
</blockquote>
<p>After extracting the hidden file from the golden_egg.jpg, we get an anonymous note. We can look at the text file with the “cat” command.</p>
<p>We can see a password in the note; since the SSH service is running on the host, the password must be related to SSH. However, we still need a username, and by looking at the message (if you are not a harry potter fan, google it), we can say that Albus Dumbledore left this message.</p>
<h3 id="brute-force-attack">Brute-Force Attack</h3>
<p>We have the password but do not have a valid username so we will use hydra to brute-force our way in with a different username. If you are unfamiliar with the hydra, check out <a href="https://www.kali.org/tools/hydra/">OffSec Services</a> <a href="https://www.kali.org/tools/hydra/">documentation</a>.</p>
<p>First, let’s create a user wordlist with different combinations of dumbledore’s name. As shown below, we can use the wordlist generator to make the process quick.</p>
<p>We will use this website called <a href="https://weakpass.com/generate">Weakpass</a> to generate a bunch of possible usernames with information we have.</p>
<p>Now, we will copy all the possible usernames into a text file named “username.txt” and use hydra to brute force into the host machine. Use the following command. To learn more about password cracking, check out <a href="https://www.guru99.com/how-to-crack-password-of-an-application.html">How to Crack a Password by Guru99</a>.</p>
<blockquote>
<p>hydra -L username.txt -p h0gwArts1sAmAg1cAlplAce 10.10.224.78 ssh</p>
</blockquote>
<p>We use “-L” to define the username wordlist, and “-p” for telling the password we possess, and then the IP address, and at the end, we describe the service we want to brute-force. If you do not understand this, head to <a href="https://www.linuxfordevices.com/tutorials/linux/hydra-brute-force-ssh">Linux for Devices</a> to learn more about SSH brute-forcing with Hydra.</p>
<p>We have successfully cracked the username and can now log in with the credentials. Use the following command.</p>
<blockquote>
<p>ssh <a href="mailto:dumbledore@10.10.145.49">dumbledore@10.10.145.49</a></p>
</blockquote>
<p>If you have never used SSH before, you read this article, <a href="https://phoenixnap.com/kb/ssh-to-connect-to-remote-server-linux-or-windows">How to Use SSH to Connect to a Remote Server in Linux or Windows by phoenixNAP</a>. </p>
<h3 id="privilege-escalation">Privilege Escalation</h3>
<p>We found an “invisibility_cloak.flag” in the current directory. Hurray! We found another flag, and now we have one last flag left. After looking around a bit, we found the last flag in the Voldemort directory. When we try to access it, we get a permission error.</p>
<p>We can check our privilege by trying a sudo command, and it looks like we do not have sudo permission. Still, we can check if we can run any command with elevated privileges. Use the following command.</p>
<blockquote>
<p>sudo -l</p>
</blockquote>
<p>We can use the copy command “cp” as sudo, so let’s see what we can do with “cp” from.</p>
<p>We can use the commands mentioned below to read the flag.</p>
<blockquote>
<p>LFILE=file_to_read<br>
sudo cp “$LFILE” /dev/stdout</p>
</blockquote>
<p>Voila! We have accessed the final flag too.</p>
<h3 id="questions--answers">Questions &amp; Answers</h3>
<ol>
<li><em>What’s the name of the spell?</em></li>
<li><em>What’s the secret phrase to unlocking the golden egg?</em></li>
<li><em>Invisibility cloak</em></li>
<li><em>Resurrection Stone</em></li>
<li><em>Elder Wand</em></li>
</ol>
<p>We have found all the flags above, and all the answers are mentioned above.</p>
<h3 id="conclusion">Conclusion</h3>
<p>So far, we have learned about FTP, SSH, and HTTP services. We also used Steghide and Hydra, and we learned how they work and can be used for specific tasks such as hiding files and brute forcing services. If you have enjoyed my writing, please to my blog.</p>

    </section>
</section>


<section class="article-post">
  <section class="main-article fade fadeup">
      <h2>Tags</h2>


      
      
          
          <a class="tag__link" href="/tags/tryhackme"><span class="tag__name">TryHackMe</span></a>
      
          
          <a class="tag__link" href="/tags/write-up"><span class="tag__name">Write-Up</span></a>
      
          
          <a class="tag__link" href="/tags/ctf"><span class="tag__name">CTF</span></a>
      




  </section>
</section>  

<section class="article-post">
  <section class="main-article fade fadeup">
  <h2>Share This Post</h2>
    <div class="share-buttons">
          <div id="description" style="display: none;">Harry Potter CTF walkthrough, This is the official write-up, and I will guide you through the whole process step by step.</div>
          <a id="facebook" class="share-button" href=""><i class="bi bi-facebook"></i></a>
          <a id="twitter" class="share-button" href=""><i class="bi bi-twitter"></i></a>
          <a id="linkedin" class="share-button" href=""><i class="bi bi-linkedin"></i></a>
          <a id="pinterest" class="share-button" href=""><i class="bi bi-pinterest"></i></a>
          <a id="reddit" class="share-button" href=""><i class="bi bi-reddit"></i></a>
    </div>  
  </section>
</section>
<script src="/assets/js/share.js"></script>



<section class="profile-section fade fadedown">
<div class="profile-card">
    <div class="profile-img">
      <img>
    </div>
    <div class="infos">
      <div class="name">
        <h2>Rahul Setrakian</h2>
        <h4>@rahulsetrakian</h4>
      </div>
      <p class="profile-text">
        I am a passionate and driven learner with diverse skills, seeking impactful collaborations.
      </p>
      <ul class="profile-stats">
        <li>
          <h3>357</h3>
          <h4>Views</h4>
        </li>
        <li>
          <h3>12</h3>
          <h4>Projects</h4>
        </li>
        <li>
          <h3>35</h3>
          <h4>Followers</h4>
        </li>
      </ul>
      <div class="profile-links">
        <button class="profile-follow"><a href="https://twitter.com/rahulsetrakian">Follow Me</a></button>
        <button class="profile-view"><a href="/about">About Me</a></button>
      </div>
    </div>
  </div>
</section>
<div id="disqus_thread" class="fade fadeup"></div>
<script>
    (function() {
        var d = document, s = d.createElement('script');
        s.src = 'https://rahulsetrakian.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        s.setAttribute('referrerpolicy', 'no-referrer-when-downgrade'); 
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<script id="dsq-count-scr" src="//rahulsetrakian.disqus.com/count.js" async></script>
<script src="/assets/js/article.js"></script>
</p>


<script data-goatcounter="https://rahulsetrakian.goatcounter.com/count"
            async src="//gc.zgo.at/count.js"></script>

</main>
<script src="/assets/js/main.js"></script>
<footer class="footer container fade-in">
	<div class="footer-container">
	  <div class="leftside">
		<h2>Main Menu</h2>
		<p>	
			<a href="/about">About</a>
			<br> 
			<a href="/portfolio">Portfolio</a>
			<br>
			<a href="/blog">Blog</a>
			<br> 
			<a href="/contact">Contact</a>
		</p>
	  </div>

	  <div class="rightside">
		<h2>Connect with Me</h2>
		<p>
			<br>
			<div class="social-icon">
		  <a href="https://in.linkedin.com/in/rahulsetrakian" title=""><i class="bi bi-linkedin"></i></a>
		  <a href="https://www.instagram.com/rahulsetrakian" title=""><i class="bi bi-instagram"></i></a>
		  <a href="https://twitter.com/rahulsetrakian" title=""><i class="bi bi-twitter-x"></i></a>
		  <a href="https://www.youtube.com/@rahulsetrakian" title=""><i class="bi bi-play-circle-fill"></i></a></div>
		  <br>
		  <br>
		</p>
	  </div>
	</div>
	<hr>
	<div class="center">
		<p class="footer-copy">© 2022, Rahul Setrakian</p>
	  </div>
  </footer>
  
<a href="#" class="scroll-icon">
	<i class='bi bi-chevron-up'></i>
</a>
</body>
</html>

